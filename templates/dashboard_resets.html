{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">
  <h2 class="mb-4">Downloads de Resets e Drivers</h2>

  <form method="GET" action="{{ url_for('dashboard_resets') }}" class="row g-2 mb-4">
    <div class="col-md-9">
      <input type="text" name="busca" class="form-control shadow-sm" placeholder="Buscar por modelo de impressora..." value="{{ termos_busca }}">
    </div>
    <div class="col-md-3 d-grid">
      <button type="submit" class="btn btn-primary shadow-sm"><i class="bi bi-search"></i> Pesquisar</button>
    </div>
  </form>

  {% if impressoras %}
  <div class="accordion" id="accordionResets">

    {% for impressora in impressoras %}
    <div class="accordion-item">
      <h2 class="accordion-header" id="heading-{{ impressora.id }}">
        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-{{ impressora.id }}" aria-expanded="false" aria-controls="collapse-{{ impressora.id }}">
          <strong><i class="bi bi-printer me-2"></i>{{ impressora.modelo }}</strong>
        </button>
      </h2>
      <div id="collapse-{{ impressora.id }}" class="accordion-collapse collapse" aria-labelledby="heading-{{ impressora.id }}" data-bs-parent="#accordionResets">
        <div class="accordion-body">

          {% if impressora.descricao %}
            <p class="text-muted">{{ impressora.descricao }}</p>
            <hr>
          {% endif %}

          <ul class="list-group">
            {% for recurso in impressora.recursos %}
              <li class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                  <strong>{{ recurso.tipo }}:</strong> {{ recurso.descricao }}
                  <small class="d-block text-muted">{{ recurso.sistema_operacional or '' }}</small>
                </div>
                <a href="{{ recurso.link_download }}" target="_blank" class="btn btn-success btn-sm">
                  <i class="bi bi-download me-1"></i> Baixar
                </a>
              </li>
            {% else %}
              <li class="list-group-item">Nenhum link cadastrado para este modelo.</li>
            {% endfor %}
          </ul>

        </div>
      </div>
    </div>
    {% endfor %}

  </div>
  {% else %}
    <div class="alert alert-info text-center">
      Nenhum modelo de impressora encontrado para sua busca.
    </div>
  {% endif %}

</div>
{% endblock %}