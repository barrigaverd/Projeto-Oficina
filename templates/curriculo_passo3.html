{% extends 'base.html' %}
{% block content %}
<div class="text-md-start">
    <button class="btn btn-secondary btn-sm px-4" onclick="retornar()">Voltar</button>
</div>
<div class="container mt-4">
    <div class="card shadow-sm rounded-3 mx-auto" style="max-width: 700px;">
        <div class="card-header bg-primary text-white text-center">
            <h4 class="mb-0">Experiências Profissionais</h4>
        </div>
        <div class="card-body">
            <form method="POST" action="">
                {{ form.hidden_tag() }}
                <div id="experiencia-container">
                    {% for experiencia_form in form.experiencias %}
                    <div class="card card-body mb-3 border-0 shadow-sm">
                        <div class="mb-2">
                            {{ experiencia_form.empresa.label(class='form-label fw-bold') }}
                            {{ experiencia_form.empresa(class='form-control') }}
                        </div>
                        <div class="mb-2">
                            {{ experiencia_form.cargo.label(class='form-label fw-bold') }}
                            {{ experiencia_form.cargo(class='form-control') }}
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-2">
                                {{ experiencia_form.data_admissao.label(class='form-label fw-bold') }}
                                {{ experiencia_form.data_admissao(class='form-control') }}
                            </div>
                            <div class="col-md-6 mb-2">
                                {{ experiencia_form.data_demissao.label(class='form-label fw-bold') }}
                                {{ experiencia_form.data_demissao(class='form-control') }}
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <div class="d-flex justify-content-between mt-3">
                    <button type="button" id="add-experiencia" class="btn btn-outline-primary btn-sm">
                        <i class="bi bi-plus-circle"></i> Adicionar Experiência
                    </button>
                    {{ form.submit(class='btn btn-success btn-sm') }}
                </div>
            </form>
        </div>
    </div>
</div>

{% endblock %}

{% block scripts %}
<script>
    const ad_experiencia = document.getElementById("add-experiencia");
    let contador = document.querySelectorAll('#experiencia-container .card').length;

    ad_experiencia.addEventListener("click", function () {
        let novo_bloco = document.createElement("div");
        novo_bloco.className = "card card-body mb-3 border-0 shadow-sm";
        novo_bloco.innerHTML = `
            <label class="form-label fw-bold">Empresa</label>
            <input type="text" name="experiencias-${contador}-empresa" class="form-control mb-2">

            <label class="form-label fw-bold">Cargo</label>
            <input type="text" name="experiencias-${contador}-cargo" class="form-control mb-2">

            <div class="row">
                <div class="col-md-6 mb-2">
                    <label class="form-label fw-bold">Data de Admissão</label>
                    <input type="date" name="experiencias-${contador}-data_admissao" class="form-control">
                </div>
                <div class="col-md-6 mb-2">
                    <label class="form-label fw-bold">Data de Demissão</label>
                    <input type="date" name="experiencias-${contador}-data_demissao" class="form-control">
                </div>
            </div>
        `;
        document.getElementById("experiencia-container").appendChild(novo_bloco);
        contador++;
    });
</script>
{% endblock %}